# UI Components & Styling

**Purpose:** shadcn/ui composition patterns, Tailwind CSS utility-first styling, and theming rules for consistent, accessible UI components.

**Last Updated:** January 2025
**Stack Version:** shadcn/ui v0.9.0+, Tailwind CSS v4.0+, React 19 compatible

**Recent Updates (January 2025):**
- ✅ **Container queries** now native in Tailwind v4 (no plugin required)
- ✅ **@theme directive** for CSS-based configuration (replaces tailwind.config.js)
- ✅ **Compound component patterns** with Radix slot architecture
- ✅ **ARIA improvements** for React 19 compatibility (aria-description support)
- ✅ **7 new structural components** (Spinner, Kbd, Button Group, Input Group, Field, Item, Empty)
- ✅ **Automated migration tool** for Tailwind v3 → v4 upgrades
- ✅ **Performance optimizations** with improved CSS generation
- ✅ **React 19 peer dependency** support across all Radix packages
- ✅ InputOTP migrated to composition pattern (removed render props)
- ✅ Tailwind v4 migration: `tw-animate-css` replaces `tailwindcss-animate`
- ✅ Chart configuration simplified (HSL theme colors no longer need `hsl()` wrapper)
- ✅ New CLI command: `npx shadcn diff` to check component updates

---

## Quick Decision Tree

```
Component Selection:
├─ Need new UI element?
│  ├─ Check docs/shadcn-components-docs/ for existing primitive
│  ├─ Use semantic component (Item, Empty, Field) over generic (Card)
│  └─ Install via shadcn CLI if missing
├─ Styling needed?
│  ├─ Use Tailwind utilities ONLY (no custom CSS)
│  ├─ Style container/wrapper, NOT structural slots
│  └─ Follow documented slot patterns exactly
└─ Dark mode?
   ├─ Use dark: prefix for utilities
   └─ CSS variables defined in app/globals.css
```

---

## Critical Rules

### ✅ MUST Follow
1. **Use shadcn/ui primitives ONLY** - All UI from `components/ui/*`, never custom components
2. **Semantic components over generic** - Item/Empty/Field instead of repetitive Card usage
3. **Never edit `components/ui/*`** - shadcn components are immutable source files
4. **Tailwind utilities ONLY** - No custom CSS, inline styles, or CSS modules
5. **Follow documented composition** - Exact structure from `docs/shadcn-components-docs/*.md`
6. **Dark mode via `dark:` prefix** - Use Tailwind's dark mode utilities, not manual class toggling
7. **CSS variables for theming** - All theme customization in `app/globals.css` via `--*` variables

### ❌ FORBIDDEN
1. **Custom styling on shadcn slots** - No `className` on Title/Description/Header slots (unless documented)
2. **Other UI libraries** - No MUI, Radix direct, Chakra, Ant Design, or any non-shadcn components
3. **Custom CSS files** - No `*.module.css`, `*.css` imports (except `globals.css`)
4. **Inline styles** - No `style={{ ... }}` prop usage (except for CSS variables like `--bg-color`)
5. **Typography components** - No `<H1>`, `<P>` components (use native HTML + Tailwind)
6. **Breaking composition** - No skipping required wrappers (e.g., CardHeader around CardTitle)
7. **Manual dark mode classes** - No `.dark` class toggling in components (use `dark:` utilities)
8. **Old InputOTP render props** - No `render` prop pattern (use composition with `InputOTPSlot`)
9. **Deprecated tailwindcss-animate** - Use `tw-animate-css` instead (Tailwind v4)
10. **React.forwardRef overuse** - Modern shadcn components use simpler ref patterns
11. **Tailwind v3 config files** - No `tailwind.config.js` (use `@theme` in CSS for Tailwind v4)
12. **Container query plugins** - No `@tailwindcss/container-queries` plugin (native in v4)
13. **Missing accessibility** - No icon-only buttons without `aria-label`, no focus removal without replacement
14. **Animations ignoring motion preferences** - No animations without `motion-safe:` or `motion-reduce:`
15. **Large unvirtualized lists** - No 100+ item lists without `@tanstack/react-virtual`
16. **Low contrast text** - No text that fails WCAG AAA (7:1 ratio for normal, 4.5:1 for large)
17. **Performant animation violations** - No animating `width`, `height`, `top`, `left`, `box-shadow` (use `transform`/`opacity`)
18. **Missing skip links** - No layouts without "Skip to main content" link for keyboard users

---

**Where you CAN add className:**
- Main component: `<Card className="...">`, `<Dialog className="...">`, `<Button className="...">`
- Layout slots: `<CardContent className="flex gap-4">`, `<CardFooter className="flex-col gap-2">`
- Content wrappers: `<div className="grid grid-cols-2">` inside CardContent

**Documented Exceptions (from shadcn/ui docs):**
```tsx
// ✅ CardFooter layout utilities (docs/shadcn-components-docs/card.md)
<CardFooter className="flex-col gap-2">
  <Button type="submit" className="w-full">Login</Button>
  <Button variant="outline" className="w-full">Login with Google</Button>
</CardFooter>

// ✅ ItemTitle line-clamp (docs/shadcn-components-docs/item.md)
<ItemTitle className="line-clamp-1">Processing payment...</ItemTitle>

// ✅ FieldLabel font-normal for checkboxes (docs/shadcn-components-docs/field.md)
<FieldLabel htmlFor="checkbox" className="font-normal">
  Accept terms
</FieldLabel>
```

---

### Pattern 3: Component Composition (Follow Documented Structure)
**When to use:** Always - every shadcn component has required hierarchy
**Implementation:**
```tsx
// ❌ WRONG - Breaking documented structure
<AlertDialog>
  <AlertDialogContent>
    <AlertDialogTitle className="text-xl">Title</AlertDialogTitle>
    {/* Missing AlertDialogHeader wrapper */}
    <AlertDialogCancel>Cancel</AlertDialogCancel>
  </AlertDialogContent>
</AlertDialog>

// ✅ CORRECT - Exact documented composition
<AlertDialog>
  <AlertDialogTrigger>Open</AlertDialogTrigger>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>Are you sure?</AlertDialogTitle>
      <AlertDialogDescription>
        This action cannot be undone.
      </AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel>Cancel</AlertDialogCancel>
      <AlertDialogAction>Continue</AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

**Required Composition Patterns:**
| Component | Required Structure | Reference |
|-----------|-------------------|-----------|
| `Card` | Card → CardHeader → CardTitle/CardDescription → CardContent → CardFooter | `docs/shadcn-components-docs/card.md` |
| `Dialog` | Dialog → DialogTrigger → DialogContent → DialogHeader → DialogTitle/DialogDescription → DialogFooter | `docs/shadcn-components-docs/dialog.md` |
| `Item` | Item → ItemMedia → ItemContent → ItemTitle/ItemDescription → ItemActions | `docs/shadcn-components-docs/item.md` |
| `Field` | Field → FieldLabel → Input/Control → FieldDescription/FieldError | `docs/shadcn-components-docs/field.md` |
| `Empty` | Empty → EmptyMedia → EmptyTitle → EmptyDescription → EmptyContent | `docs/shadcn-components-docs/empty.md` |

---

### Pattern 4: Responsive Design (Mobile-First with Breakpoint Prefixes)
**When to use:** All layouts requiring responsive behavior
**Implementation:**
```tsx
// ❌ WRONG - Desktop-first or no responsive design
<div className="w-64">
  <img src="..." />
</div>

// ✅ CORRECT - Mobile-first with breakpoint prefixes
<div className="w-full md:w-1/2 lg:w-1/3">
  <img className="w-16 md:w-32 lg:w-48" src="..." />
</div>

// ✅ CORRECT - Responsive grid
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
  {items.map(item => <ItemCard key={item.id} {...item} />)}
</div>

// ✅ CORRECT - Breakpoint-specific utilities
<div className="flex flex-col md:flex-row md:items-center md:gap-6">
  <img className="mx-auto md:mx-0" src="..." />
  <div className="text-center md:text-left">...</div>
</div>
```

**Default Breakpoints (Tailwind CSS v4):**
```css
/* Mobile-first approach */
sm:   /* @media (min-width: 640px) */
md:   /* @media (min-width: 768px) */
lg:   /* @media (min-width: 1024px) */
xl:   /* @media (min-width: 1280px) */
2xl:  /* @media (min-width: 1536px) */
```

**Custom Breakpoints (if needed):**
```css
/* app/globals.css */
@theme {
  --breakpoint-3xl: 120rem; /* 1920px */
}
```

```tsx
{/* Usage */}
<div className="grid grid-cols-2 md:grid-cols-4 3xl:grid-cols-6">
  {/* ... */}
</div>
```

---

### Pattern 5: Dark Mode (CSS Variables + dark: Prefix)
**When to use:** All components needing dark mode support
**Implementation:**
```tsx
// ❌ WRONG - Manual dark mode class toggling
const [isDark, setIsDark] = useState(false)

<div className={isDark ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}>
  <h1>Title</h1>
</div>

// ✅ CORRECT - Tailwind dark: utilities
<div className="bg-white dark:bg-gray-900">
  <h1 className="text-gray-900 dark:text-white">Title</h1>
  <p className="text-gray-500 dark:text-gray-400">Description</p>
</div>

// ✅ CORRECT - Component with dark mode
<Card className="bg-white dark:bg-gray-800">
  <CardHeader>
    <CardTitle className="text-gray-900 dark:text-white">Stats</CardTitle>
    <CardDescription className="text-gray-500 dark:text-gray-400">
      Monthly revenue
    </CardDescription>
  </CardHeader>
  <CardContent>
    <div className="border border-gray-200 dark:border-gray-700">...</div>
  </CardContent>
</Card>
```

**Dark Mode Activation (automatic via system preference):**
```tsx
// app/layout.tsx - NO manual toggling needed
export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body className="bg-white dark:bg-gray-950 text-gray-950 dark:text-white">
        {children}
      </body>
    </html>
  )
}
```

---

### Pattern 6: Typography (Native HTML + Tailwind Utilities)
**When to use:** All text content
**Implementation:**
```tsx
// ❌ WRONG - Typography components (don't exist in shadcn/ui)
import { H1, H2, P } from '@/components/ui/typography' // This file doesn't exist!

<H1>Heading</H1>
<P>Paragraph</P>

// ✅ CORRECT - Native HTML with Tailwind classes
<h1 className="scroll-m-20 text-4xl font-extrabold tracking-tight text-balance">
  Heading Text
</h1>
<p className="leading-7 [&:not(:first-child)]:mt-6">
  Paragraph text with proper spacing.
</p>

// ✅ CORRECT - Full typography example
<div className="prose dark:prose-invert">
  <h1 className="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl">
    Main Heading
  </h1>
  <h2 className="mt-10 scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight">
    Subheading
  </h2>
  <p className="leading-7 [&:not(:first-child)]:mt-6">
    Body text with automatic spacing and proper line height.
  </p>
  <blockquote className="mt-6 border-l-2 pl-6 italic">
    "Quote text with proper styling."
  </blockquote>
</div>
```

**Reference:** `docs/shadcn-components-docs/typography.md` contains utility class examples for all typography needs.

---

### Pattern 7: Form Components (Field + InputGroup)
**When to use:** All form layouts
**Implementation:**
```tsx
// ❌ WRONG - Bare inputs without Field wrapper
<div>
  <label>Username</label>
  <input type="text" />
  <p>Choose a unique username</p>
</div>

// ✅ CORRECT - Field component pattern
import { Field, FieldLabel, FieldDescription } from "@/components/ui/field"
import { Input } from "@/components/ui/input"

<Field>
  <FieldLabel htmlFor="username">Username</FieldLabel>
  <Input id="username" placeholder="johndoe" />
  <FieldDescription>
    Choose a unique username for your account.
  </FieldDescription>
</Field>

// ✅ CORRECT - InputGroup for complex inputs
import { InputGroup, InputGroupInput, InputGroupAddon } from "@/components/ui/input-group"
import { SearchIcon } from "lucide-react"

<InputGroup>
  <InputGroupInput placeholder="Search..." />
  <InputGroupAddon align="inline-end">
    <SearchIcon />
  </InputGroupAddon>
</InputGroup>

// ✅ CORRECT - Responsive field layout
<Field orientation="responsive">
  <FieldContent>
    <FieldLabel htmlFor="name">Full Name</FieldLabel>
    <FieldDescription>
      Provide your full name for identification
    </FieldDescription>
  </FieldContent>
  <Input id="name" placeholder="John Doe" required />
</Field>
```

---

### Pattern 8: Lists and Collections (Item + ItemGroup)
**When to use:** Displaying lists, user profiles, notifications, any repeated content
**Implementation:**
```tsx
// ❌ WRONG - Manual list with divs
<div className="space-y-4">
  {users.map(user => (
    <div key={user.id} className="flex gap-4 p-4 border rounded">
      <img src={user.avatar} />
      <div>
        <h3>{user.name}</h3>
        <p>{user.email}</p>
      </div>
      <button>Follow</button>
    </div>
  ))}
</div>

// ✅ CORRECT - Item component with proper composition
import { Item, ItemMedia, ItemContent, ItemTitle, ItemDescription, ItemActions, ItemGroup, ItemSeparator } from "@/components/ui/item"
import { Avatar, AvatarImage, AvatarFallback } from "@/components/ui/avatar"
import { Button } from "@/components/ui/button"

<ItemGroup>
  {users.map((user, index) => (
    <React.Fragment key={user.id}>
      <Item>
        <ItemMedia>
          <Avatar>
            <AvatarImage src={user.avatar} />
            <AvatarFallback>{user.name.charAt(0)}</AvatarFallback>
          </Avatar>
        </ItemMedia>
        <ItemContent>
          <ItemTitle>{user.name}</ItemTitle>
          <ItemDescription>{user.email}</ItemDescription>
        </ItemContent>
        <ItemActions>
          <Button size="sm" variant="outline">Follow</Button>
        </ItemActions>
      </Item>
      {index !== users.length - 1 && <ItemSeparator />}
    </React.Fragment>
  ))}
</ItemGroup>

// ✅ CORRECT - Clickable item as link
<Item variant="outline" asChild>
  <a href={`/users/${user.id}`}>
    <ItemContent>
      <ItemTitle>{user.name}</ItemTitle>
      <ItemDescription>View profile</ItemDescription>
    </ItemContent>
    <ItemActions>
      <ChevronRightIcon className="size-4" />
    </ItemActions>
  </a>
</Item>
```

---

### Pattern 9: Empty States (Empty Component)
**When to use:** No data, no results, initial states, error states
**Implementation:**
```tsx
// ❌ WRONG - Card for empty state
<Card>
  <CardHeader>
    <CardTitle>No Messages</CardTitle>
  </CardHeader>
  <CardContent>
    <p>You don't have any messages yet.</p>
    <Button>Send Message</Button>
  </CardContent>
</Card>

// ✅ CORRECT - Empty component
import { Empty, EmptyMedia, EmptyTitle, EmptyDescription, EmptyContent } from "@/components/ui/empty"
import { InboxIcon } from "lucide-react"
import { Button } from "@/components/ui/button"

<Empty>
  <EmptyMedia variant="icon">
    <InboxIcon />
  </EmptyMedia>
  <EmptyTitle>No messages</EmptyTitle>
  <EmptyDescription>You don't have any messages yet.</EmptyDescription>
  <EmptyContent>
    <Button>Send a message</Button>
  </EmptyContent>
</Empty>

// ✅ CORRECT - Empty state with search input
<Empty>
  <EmptyTitle>404 - Not Found</EmptyTitle>
  <EmptyDescription>
    The page you're looking for doesn't exist. Try searching below.
  </EmptyDescription>
  <EmptyContent>
    <InputGroup className="sm:w-3/4">
      <InputGroupInput placeholder="Try searching for pages..." />
      <InputGroupAddon>
        <SearchIcon />
      </InputGroupAddon>
    </InputGroup>
  </EmptyContent>
</Empty>
```

---

### Pattern 10: Loading States (Spinner Component)
**When to use:** Async operations, loading data, processing actions
**Implementation:**
```tsx
// ❌ WRONG - Custom loading spinner
<div className="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900" />

// ✅ CORRECT - Spinner component
import { Spinner } from "@/components/ui/spinner"

<Spinner />

// ✅ CORRECT - Button with loading state
import { Button } from "@/components/ui/button"

<Button disabled>
  <Spinner />
  Loading...
</Button>

// ✅ CORRECT - Input with loading indicator
<InputGroup data-disabled>
  <InputGroupInput placeholder="Searching..." disabled />
  <InputGroupAddon align="inline-end">
    <Spinner />
  </InputGroupAddon>
</InputGroup>
```

---

### Pattern 11: Button Groups and Actions
**When to use:** Related actions, toolbars, split buttons
**Implementation:**
```tsx
// ❌ WRONG - Manual button spacing
<div className="flex gap-2">
  <button>Save</button>
  <button>Cancel</button>
  <button>Delete</button>
</div>

// ✅ CORRECT - ButtonGroup component
import { ButtonGroup } from "@/components/ui/button-group"
import { Button } from "@/components/ui/button"

<ButtonGroup>
  <Button variant="outline">Save</Button>
  <Button variant="outline">Cancel</Button>
</ButtonGroup>

// ✅ CORRECT - Nested button groups with spacing
<ButtonGroup>
  <ButtonGroup>
    <Button variant="outline">Archive</Button>
    <Button variant="outline">Report</Button>
  </ButtonGroup>
  <ButtonGroup>
    <Button variant="outline">Snooze</Button>
    <Button variant="outline" size="icon">
      <MoreHorizontalIcon />
    </Button>
  </ButtonGroup>
</ButtonGroup>

// ✅ CORRECT - Split button with dropdown
<ButtonGroup>
  <Button variant="outline">Follow</Button>
  <DropdownMenu>
    <DropdownMenuTrigger asChild>
      <Button variant="outline" className="!pl-2">
        <ChevronDownIcon />
      </Button>
    </DropdownMenuTrigger>
    <DropdownMenuContent align="end">
      {/* ... menu items */}
    </DropdownMenuContent>
  </DropdownMenu>
</ButtonGroup>
```

---

---

### Pattern 13: InputOTP Composition (Updated Nov 2025)
**When to use:** OTP/verification code inputs
**Breaking Change:** Render props pattern deprecated, use composition instead
**Implementation:**
```tsx
// ❌ OLD - Render props pattern (DEPRECATED)
import { OTPInput, SlotProps } from "input-otp"

const InputOTPSlot = React.forwardRef<
  React.ElementRef<"div">,
  SlotProps & React.ComponentPropsWithoutRef<"div">
>(({ char, hasFakeCaret, isActive, className, ...props }, ref) => {
  // Old implementation
})

<InputOTP maxLength={6} render={({ slots }) => (
  // Render props usage
)} />

// ✅ CORRECT - Composition pattern (Current)
import { OTPInput, OTPInputContext } from "input-otp"
import { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator } from "@/components/ui/input-otp"

const InputOTPSlot = React.forwardRef<
  React.ElementRef<"div">,
  React.ComponentPropsWithoutRef<"div"> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext)
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]
  // New implementation using context
})

<InputOTP maxLength={6}>
  <InputOTPGroup>
    <InputOTPSlot index={0} />
    <InputOTPSlot index={1} />
    <InputOTPSlot index={2} />
  </InputOTPGroup>
  <InputOTPSeparator />
  <InputOTPGroup>
    <InputOTPSlot index={3} />
    <InputOTPSlot index={4} />
    <InputOTPSlot index={5} />
  </InputOTPGroup>
</InputOTP>
```

**Migration:**
```bash
# Update input-otp package to latest
npm install input-otp@latest

# Update component file
npx shadcn@latest add input-otp --overwrite
```

---

### Pattern 14: Sidebar Component (New Component)
**When to use:** App navigation, collapsible side panels
**Implementation:**
```tsx
// ✅ CORRECT - Basic sidebar setup
import { Sidebar, SidebarContent, SidebarHeader, SidebarFooter } from "@/components/ui/sidebar"

export function AppSidebar() {
  return (
    <Sidebar>
      <SidebarHeader>
        <h2>App Name</h2>
      </SidebarHeader>
      <SidebarContent>
        {/* Navigation items */}
      </SidebarContent>
      <SidebarFooter>
        {/* User profile, settings */}
      </SidebarFooter>
    </Sidebar>
  )
}

// ✅ CORRECT - Usage in layout
import { SidebarProvider, SidebarTrigger } from "@/components/ui/sidebar"
import { AppSidebar } from "@/components/app-sidebar"

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <SidebarProvider>
      <AppSidebar />
      <main>
        <SidebarTrigger />
        {children}
      </main>
    </SidebarProvider>
  )
}
```

**Installation:**
```bash
npx shadcn@latest add sidebar
```

---

### Pattern 16: Checking for Component Updates (New CLI Feature)
**When to use:** Maintaining up-to-date components
**Implementation:**
```bash
# Check all components for updates
npx shadcn diff

# Check specific component
npx shadcn diff button

# View detailed changes
npx shadcn diff calendar

# Update all components (commit changes first!)
git add .
git commit -m "chore: prepare for component updates"
npx shadcn@latest add --all --overwrite
```

**Best Practice:**
- Run `npx shadcn diff` monthly to catch updates
- Always commit before running `--overwrite`
- Review diffs before applying updates
- Test components after bulk updates

---

### Pattern 17: Container Queries (Native in Tailwind v4)
**When to use:** Responsive components based on container size, not viewport
**Breaking Change:** No plugin needed in v4 (previously required @tailwindcss/container-queries)
**Implementation:**
```tsx
// ✅ CORRECT - Container query pattern (Tailwind v4)
<div className="@container">
  <div className="@md:flex @md:gap-4">
    {/* Layout changes when container (not viewport) hits @md breakpoint */}
    <div className="@lg:w-1/2">
      <h3 className="text-base @md:text-lg @xl:text-2xl">
        Responsive to container size
      </h3>
    </div>
  </div>
</div>

// ✅ CORRECT - Custom container breakpoints
/* app/globals.css */
@import "tailwindcss";

@theme {
  --container-sm: 20rem;    /* 320px */
  --container-md: 28rem;    /* 448px */
  --container-lg: 32rem;    /* 512px */
  --container-xl: 36rem;    /* 576px */
}
```tsx
<div className="@container">
  <div className="grid @sm:grid-cols-2 @lg:grid-cols-3">
    {/* Grid adapts to container, not viewport */}
  </div>
</div>

// ✅ CORRECT - Container query units (cqw, cqh, cqi, cqb)
<div className="@container">
  <div className="w-[50cqw] h-[25cqh]">
    {/* 50% of container width, 25% of container height */}
  </div>
  <p className="text-[4cqi]">
    {/* Font size: 4% of container inline size */}
  </p>
</div>

// ❌ WRONG - Using viewport breakpoints for component-level responsiveness
<div className="md:flex md:gap-4">
  {/* This responds to viewport, not container - wrong for reusable components */}
</div>
```

**When to use container queries vs viewport breakpoints:**
- **Container queries (`@md:`, `@lg:`)**: Reusable components that need to adapt based on their container
- **Viewport breakpoints (`md:`, `lg:`)**: Page-level layouts that respond to screen size

**Migration from v3:**
```diff
- /* tailwind.config.js */
- module.exports = {
-   plugins: [require('@tailwindcss/container-queries')]
- }

+ /* No config needed - container queries are built-in */
```

---

### Pattern 18: Fluid Typography (Tailwind v4 with @theme)
**When to use:** Typography that scales smoothly between breakpoints
**Implementation:**
```css
/* app/globals.css */
@import "tailwindcss";

@theme {
  /* Fluid font sizes using clamp() */
  --font-size-fluid-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
  --font-size-fluid-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem);
  --font-size-fluid-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
  --font-size-fluid-lg: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
  --font-size-fluid-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
  --font-size-fluid-2xl: clamp(1.5rem, 1.3rem + 1vw, 1.875rem);
  --font-size-fluid-3xl: clamp(1.875rem, 1.6rem + 1.375vw, 2.25rem);
  --font-size-fluid-4xl: clamp(2.25rem, 1.9rem + 1.75vw, 3rem);

  /* Fluid spacing */
  --spacing-fluid-xs: clamp(0.5rem, 0.4rem + 0.5vw, 0.75rem);
  --spacing-fluid-sm: clamp(0.75rem, 0.6rem + 0.75vw, 1rem);
  --spacing-fluid-md: clamp(1rem, 0.8rem + 1vw, 1.5rem);
  --spacing-fluid-lg: clamp(1.5rem, 1.2rem + 1.5vw, 2rem);
  --spacing-fluid-xl: clamp(2rem, 1.6rem + 2vw, 3rem);
}
```

```tsx
// ✅ CORRECT - Fluid typography usage
<h1 className="text-[--font-size-fluid-4xl] font-bold">
  Scales smoothly from mobile to desktop
</h1>

<div className="px-[--spacing-fluid-md] py-[--spacing-fluid-lg]">
  Fluid spacing adapts to viewport
</div>

// ✅ CORRECT - Combining with container queries for component-level fluidity
<div className="@container">
  <h2 className="text-[--font-size-fluid-xl] @lg:text-[--font-size-fluid-3xl]">
    Fluid within container size ranges
  </h2>
</div>

// ❌ WRONG - Fixed breakpoint jumps (jarring transitions)
<h1 className="text-2xl md:text-4xl lg:text-6xl">
  Jumps at breakpoints instead of smooth scaling
</h1>
```

**Best Practices:**
- Use fluid typography for headings and hero sections
- Keep body text at fixed sizes for readability
- Test at all viewport sizes to avoid too-small or too-large text
- Use container queries for component-level fluid scaling

---

### Pattern 19: Advanced Accessibility (WCAG 2.1 AAA Compliance)
**When to use:** All production components requiring enterprise-grade accessibility
**Built-in via Radix UI:** Most patterns handled automatically
**Implementation:**

#### Focus Management
```tsx
// ✅ CORRECT - Focus trap in Dialog (automatic via Radix)
<Dialog>
  <DialogTrigger asChild>
    <Button>Open Settings</Button>
  </DialogTrigger>
  <DialogContent>
    {/* Focus automatically moves to first focusable element */}
    {/* Escape closes and restores focus to trigger */}
    <DialogHeader>
      <DialogTitle>Settings</DialogTitle>
    </DialogHeader>
    <Input autoFocus placeholder="Search settings..." />
    <DialogFooter>
      <Button type="submit">Save</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>

// ✅ CORRECT - Custom focus visible styles
<Button className="focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2">
  Accessible focus indicator
</Button>

// ❌ WRONG - Removing focus outline without replacement
<Button className="focus:outline-none">
  No focus indicator - inaccessible for keyboard users
</Button>
```

#### ARIA Labels and Descriptions (React 19)
```tsx
// ✅ CORRECT - aria-description (React 19 native support)
<Button
  aria-label="Delete user account"
  aria-description="This action cannot be undone"
>
  Delete Account
</Button>

// ✅ CORRECT - aria-describedby for complex descriptions
<Field>
  <FieldLabel htmlFor="password">Password</FieldLabel>
  <Input
    id="password"
    type="password"
    aria-describedby="password-requirements"
  />
  <FieldDescription id="password-requirements">
    Must be at least 8 characters with uppercase, lowercase, and numbers
  </FieldDescription>
</Field>

// ✅ CORRECT - aria-live for dynamic content
<div aria-live="polite" aria-atomic="true">
  {isLoading ? "Loading..." : `${items.length} items loaded`}
</div>

// ❌ WRONG - Missing labels for icon-only buttons
<Button size="icon">
  <TrashIcon />
  {/* Screen readers don't know what this does */}
</Button>

// ✅ FIX - Add aria-label
<Button size="icon" aria-label="Delete item">
  <TrashIcon />
</Button>
```

#### Keyboard Navigation Patterns
```tsx
// ✅ CORRECT - Dropdown with automatic keyboard support (via Radix)
<DropdownMenu>
  <DropdownMenuTrigger>Actions</DropdownMenuTrigger>
  <DropdownMenuContent>
    {/* Arrow keys navigate, Enter/Space activate, Escape closes */}
    <DropdownMenuItem onSelect={() => console.log('Edit')}>
      <EditIcon className="mr-2 h-4 w-4" />
      Edit
    </DropdownMenuItem>
    <DropdownMenuItem onSelect={() => console.log('Delete')}>
      <TrashIcon className="mr-2 h-4 w-4" />
      Delete
    </DropdownMenuItem>
  </DropdownMenuContent>
</DropdownMenu>

// ✅ CORRECT - Custom keyboard handler (when needed)
<div
  role="button"
  tabIndex={0}
  onClick={handleClick}
  onKeyDown={(e) => {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault()
      handleClick()
    }
  }}
>
  Custom interactive element
</div>

// ❌ WRONG - Click-only interactive element
<div onClick={handleClick}>
  Not accessible for keyboard users
</div>
```

#### Color Contrast (WCAG AAA: 7:1 for normal text, 4.5:1 for large text)
```tsx
// ✅ CORRECT - Ensure sufficient contrast via CSS variables
/* app/globals.css */
:root {
  --foreground: oklch(0.145 0 0);      /* Near black */
  --background: oklch(1 0 0);          /* White */
  --muted-foreground: oklch(0.45 0 0); /* 7:1 contrast with background */
}

.dark {
  --foreground: oklch(0.985 0 0);      /* Near white */
  --background: oklch(0.145 0 0);      /* Near black */
  --muted-foreground: oklch(0.65 0 0); /* 7:1 contrast with background */
}

// ✅ CORRECT - Text with sufficient contrast
<p className="text-foreground">
  High contrast (WCAG AAA compliant)
</p>

<p className="text-muted-foreground">
  Muted but still WCAG AAA compliant
</p>

// ❌ WRONG - Low contrast text
<p className="text-gray-400 dark:text-gray-600">
  Likely fails WCAG contrast requirements
</p>
```

#### Screen Reader Announcements
```tsx
// ✅ CORRECT - Success toast with announcement
import { toast } from "sonner"

toast.success("Item saved successfully", {
  description: "Your changes have been saved",
  // Automatically announced to screen readers
})

// ✅ CORRECT - Loading state with aria-live
<div aria-live="assertive" aria-busy={isLoading}>
  {isLoading ? (
    <>
      <Spinner />
      <span className="sr-only">Loading data, please wait...</span>
    </>
  ) : (
    <span>Data loaded</span>
  )}
</div>

// ✅ CORRECT - Visually hidden but screen reader accessible
<Button>
  <span className="sr-only">Search</span>
  <SearchIcon aria-hidden="true" />
</Button>
```

#### Skip Links (WCAG 2.4.1)
```tsx
// ✅ CORRECT - Skip to main content link
// app/layout.tsx
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <a
          href="#main-content"
          className="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground"
        >
          Skip to main content
        </a>
        <header>{/* ... */}</header>
        <main id="main-content" tabIndex={-1}>
          {children}
        </main>
      </body>
    </html>
  )
}
```

**Accessibility Checklist:**
- [ ] All interactive elements keyboard accessible (Tab, Enter, Space, Escape, Arrows)
- [ ] Focus indicators visible (no `focus:outline-none` without replacement)
- [ ] Icon-only buttons have aria-label
- [ ] Form inputs have associated labels (FieldLabel with htmlFor)
- [ ] Color contrast meets WCAG AAA (7:1 for normal text, 4.5:1 for large)
- [ ] Dynamic content uses aria-live
- [ ] Modals trap focus and restore on close
- [ ] Skip links provided for keyboard navigation
- [ ] All images have alt text (or aria-hidden for decorative)
- [ ] Page has descriptive title and lang attribute

---

### Pattern 20: Animation Performance (Reduced Motion Support)
**When to use:** All animations and transitions
**Implementation:**
```tsx
// ✅ CORRECT - Respect prefers-reduced-motion
/* app/globals.css */
@import "tailwindcss";
@import "tw-animate-css";

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

// ✅ CORRECT - Motion-safe animations
<div className="motion-safe:animate-fade-in motion-reduce:opacity-100">
  Respects user's motion preferences
</div>

<Button className="transition-colors motion-safe:transition-all">
  Smooth transitions only if user allows motion
</Button>

// ✅ CORRECT - Skeleton screens (better than spinners for perceived performance)
import { Skeleton } from "@/components/ui/skeleton"

{isLoading ? (
  <div className="space-y-4">
    <Skeleton className="h-12 w-full" />
    <Skeleton className="h-12 w-full" />
    <Skeleton className="h-12 w-full" />
  </div>
) : (
  <ItemGroup>
    {items.map(item => <Item key={item.id} {...item} />)}
  </ItemGroup>
)}

// ✅ CORRECT - Optimistic UI animations
"use client"

import { useOptimistic } from "react"

export function TodoList({ todos }) {
  const [optimisticTodos, addOptimisticTodo] = useOptimistic(
    todos,
    (state, newTodo) => [...state, { ...newTodo, pending: true }]
  )

  async function createTodo(formData: FormData) {
    const newTodo = { id: Date.now(), text: formData.get("text") }
    addOptimisticTodo(newTodo)
    await createTodoAction(formData)
  }

  return (
    <form action={createTodo}>
      <Input name="text" />
      <Button type="submit">Add</Button>
      <ItemGroup>
        {optimisticTodos.map(todo => (
          <Item key={todo.id} className={todo.pending ? "opacity-50" : ""}>
            <ItemContent>
              <ItemTitle>{todo.text}</ItemTitle>
              {todo.pending && <span className="text-xs text-muted-foreground">Saving...</span>}
            </ItemContent>
          </Item>
        ))}
      </ItemGroup>
    </form>
  )
}

// ❌ WRONG - Animations without reduced-motion support
<div className="animate-bounce">
  Ignores user accessibility preferences
</div>
```

**Animation Performance Best Practices:**
- Use `transform` and `opacity` (GPU-accelerated) instead of `top`, `left`, `width`, `height`
- Avoid animating `box-shadow` (use `drop-shadow` filter instead)
- Respect `prefers-reduced-motion` for all animations
- Use skeleton screens for loading states (better perceived performance)
- Implement optimistic UI for instant feedback
- Keep animations under 300ms for perceived snappiness

---

### Pattern 21: Component Performance Optimization
**When to use:** Large lists, complex components, re-render heavy sections
**Implementation:**
```tsx
// ✅ CORRECT - Virtualized lists for performance
import { useVirtualizer } from '@tanstack/react-virtual'

export function VirtualizedList({ items }: { items: Item[] }) {
  const parentRef = React.useRef<HTMLDivElement>(null)

  const virtualizer = useVirtualizer({
    count: items.length,
    getScrollElement: () => parentRef.current,
    estimateSize: () => 72, // Estimated row height
  })

  return (
    <div ref={parentRef} className="h-[600px] overflow-auto">
      <div
        style={{
          height: `${virtualizer.getTotalSize()}px`,
          position: 'relative',
        }}
      >
        {virtualizer.getVirtualItems().map((virtualRow) => (
          <div
            key={virtualRow.index}
            style={{
              position: 'absolute',
              top: 0,
              left: 0,
              width: '100%',
              height: `${virtualRow.size}px`,
              transform: `translateY(${virtualRow.start}px)`,
            }}
          >
            <Item>
              <ItemContent>
                <ItemTitle>{items[virtualRow.index].name}</ItemTitle>
              </ItemContent>
            </Item>
          </div>
        ))}
      </div>
    </div>
  )
}

// ✅ CORRECT - Lazy loading images
<img
  src={item.imageUrl}
  alt={item.name}
  loading="lazy"
  className="w-full h-auto"
/>

// ✅ CORRECT - Code splitting for heavy components
import dynamic from 'next/dynamic'

const Chart = dynamic(() => import('@/components/ui/chart'), {
  loading: () => <Skeleton className="h-[400px]" />,
  ssr: false, // Skip SSR for client-only charts
})

// ✅ CORRECT - Memoize expensive computations
import { useMemo } from 'react'

export function ExpensiveComponent({ data }: { data: Data[] }) {
  const processedData = useMemo(() => {
    return data.map(item => complexCalculation(item))
  }, [data])

  return <Chart data={processedData} />
}

// ❌ WRONG - Rendering 1000+ items without virtualization
<div>
  {items.map(item => (
    <Item key={item.id}>
      <ItemContent>
        <ItemTitle>{item.name}</ItemTitle>
      </ItemContent>
    </Item>
  ))}
</div>
```

**Performance Checklist:**
- [ ] Virtualize lists with 100+ items
- [ ] Use `loading="lazy"` for below-fold images
- [ ] Code split heavy components (charts, editors)
- [ ] Memoize expensive calculations
- [ ] Avoid inline function definitions in props
- [ ] Use React.memo for pure components that re-render often
- [ ] Debounce search inputs
- [ ] Use Suspense boundaries for async components

---

## Detection Commands

```bash
# Check for custom CSS files (should only find globals.css)
find . -name "*.css" -not -path "*/node_modules/*" -not -name "globals.css"

# Check for inline styles (FORBIDDEN except CSS variables)
rg "style={{" --type tsx --type ts | grep -v "\-\-"

# Check for custom styling on shadcn slots (common violations)
rg "CardTitle className=\"" --type tsx
rg "CardDescription className=\"" --type tsx
rg "DialogTitle className=\"" --type tsx
rg "AlertDialogDescription className=\"" --type tsx

# Check for typography components (don't exist)
rg "from ['\"]@/components/ui/typography['\"]" --type tsx

# Check for manual dark mode class toggling (use dark: prefix instead)
rg "className={\`.*\${.*dark.*}.*\`}" --type tsx
rg "className={.*\?.*'dark'.*:.*}" --type tsx

# Check for CSS modules (FORBIDDEN)
find . -name "*.module.css" -not -path "*/node_modules/*"

# Verify shadcn/ui component usage
rg "from ['\"]@/components/ui/" --type tsx -A 1 | head -20

# Check for proper Field usage (forms)
rg "Field(Label|Description|Error)" --type tsx | wc -l

# Check for proper Item usage (lists)
rg "Item(Content|Title|Description|Media|Actions)" --type tsx | wc -l

# NEW: Check for deprecated InputOTP render props pattern
rg "InputOTP.*render=" --type tsx
rg "from \"input-otp\".*SlotProps" --type tsx

# NEW: Check for deprecated tailwindcss-animate plugin
rg "@plugin ['\"]tailwindcss-animate['\"]" --glob "*.css"

# NEW: Verify tw-animate-css is used (Tailwind v4)
rg "@import \"tw-animate-css\"" --glob "*.css"

# NEW: Check for outdated Chart config (should not wrap with hsl())
rg "hsl\(var\(--chart-" --type tsx

# NEW: Check for available component updates
npx shadcn diff

# NEW: Verify React 19 peer dependencies (if using React 19)
rg "\"react\".*\^19" package.json
rg "peerDependencies" node_modules/@radix-ui/*/package.json | grep -A 2 "react"

# NEW: Check for container queries usage (Tailwind v4)
rg "@container" --type tsx --type css
rg "@md:|@lg:|@xl:" --type tsx

# NEW: Check for accessibility violations
rg "focus:outline-none" --type tsx | grep -v "focus-visible"
rg "<Button.*size=\"icon\"" --type tsx | grep -v "aria-label"
rg "<img" --type tsx | grep -v "alt="

# NEW: Check for missing aria-label on icon-only buttons
rg "size=\"icon\"" --type tsx -A 2 -B 2 | grep -v "aria-label"

# NEW: Check for animations without reduced-motion support
rg "animate-" --type tsx | grep -v "motion-safe" | grep -v "motion-reduce"

# NEW: Check for non-performant animations (avoid animating these properties)
rg "transition-\[.*width.*\]|transition-\[.*height.*\]|transition-\[.*top.*\]|transition-\[.*left.*\]" --type tsx

# NEW: Check for large lists without virtualization (100+ items)
rg "\.map\(" --type tsx -A 1 | grep -E "items\.length > 100|items\.length >= 100"

# NEW: Check for fluid typography usage
rg "\-\-font-size-fluid|text-\[\-\-font-size-fluid" --type tsx --type css

# NEW: Verify @theme directive usage (Tailwind v4)
rg "@theme" --type css

# NEW: Check for Tailwind v3 plugin imports (should be removed in v4)
rg "@plugin|require\(" --type css

# NEW: Check for aria-description usage (React 19)
rg "aria-description=" --type tsx

# NEW: Check for skip links implementation
rg "Skip to main content|#main-content" --type tsx

# NEW: Check for aria-live regions for dynamic content
rg "aria-live=" --type tsx

# NEW: Verify color contrast variables (should use oklch)
rg "oklch\(" app/globals.css
```

---

## Accessibility (Built into shadcn/ui)

shadcn/ui components are built on Radix UI primitives, which include:

**Automatic ARIA Attributes:**
- `role`, `aria-labelledby`, `aria-describedby` on all interactive elements
- `aria-expanded`, `aria-haspopup` for dropdowns/popovers
- `aria-checked`, `aria-selected` for form controls
- `aria-hidden` for decorative icons

**Keyboard Navigation:**
- `Tab`/`Shift+Tab` for focus management
- `Enter`/`Space` for activation
- `Escape` to close dialogs/popovers
- Arrow keys for dropdown/select navigation

**Screen Reader Support:**
- Semantic HTML structure
- Proper heading hierarchy
- Form label associations via `htmlFor`
- Live region announcements for dynamic content

**Focus Management:**
- Visible focus indicators (via `ring` utilities)
- Focus trapping in modals/dialogs
- Focus restoration on close

**Example (Dialog with full accessibility):**
```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Open Dialog</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Are you absolutely sure?</DialogTitle> {/* aria-labelledby */}
      <DialogDescription> {/* aria-describedby */}
        This action cannot be undone. This will permanently delete your account.
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <Button variant="outline">Cancel</Button>
      <Button variant="destructive">Delete Account</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

**All accessibility handled automatically - no manual ARIA needed.**

---

## Component Installation

```bash
# Install individual components
npx shadcn@latest add button
npx shadcn@latest add card
npx shadcn@latest add dialog

# Install October 2025 new components
npx shadcn@latest add spinner
npx shadcn@latest add kbd
npx shadcn@latest add button-group
npx shadcn@latest add input-group
npx shadcn@latest add field
npx shadcn@latest add item
npx shadcn@latest add empty

# Check available components
npx shadcn@latest add
```

---

## Quick Reference

| Pattern | When | Example | Since |
|---------|------|---------|-------|
| Semantic Components | Always (avoid Card overuse) | `<Item>` for lists, `<Empty>` for no data, `<Field>` for forms | v0.8.0 |
| Slot Styling | Never (unless documented) | `<CardTitle>Text</CardTitle>` - no className | v0.1.0 |
| Layout Styling | Always (containers only) | `<CardContent className="flex gap-4">` | v0.1.0 |
| Dark Mode | All components | `className="bg-white dark:bg-gray-900"` | v0.1.0 |
| Responsive | Mobile-first | `className="w-full md:w-1/2 lg:w-1/3"` | v0.1.0 |
| Typography | Native HTML + utilities | `<h1 className="text-4xl font-extrabold">` | v0.1.0 |
| Forms | Field component | `<Field><FieldLabel>...</FieldLabel><Input /></Field>` | v0.8.0 |
| Lists | Item + ItemGroup | `<ItemGroup><Item>...</Item></ItemGroup>` | v0.8.0 |
| Empty States | Empty component | `<Empty><EmptyTitle>...</EmptyTitle></Empty>` | v0.8.0 |
| Loading | Spinner component | `<Button disabled><Spinner />Loading</Button>` | v0.8.0 |
| InputOTP | Composition (not render) | `<InputOTP><InputOTPGroup><InputOTPSlot index={0} /></InputOTPGroup></InputOTP>` | v0.9.0 |
| Sidebar | App navigation | `<SidebarProvider><Sidebar><SidebarContent /></Sidebar></SidebarProvider>` | v0.9.0 |
| CSS Variables | Dynamic theming | `style={{ "--bg-color": color }}` + `className="bg-(--bg-color)"` | Tailwind v4 |
| Component Updates | Check monthly | `npx shadcn diff` | v0.9.0 |
| **Container Queries** | **Component-level responsive** | `<div className="@container"><div className="@md:flex">...</div></div>` | **Tailwind v4** |
| **Fluid Typography** | **Smooth scaling headings** | `className="text-[--font-size-fluid-4xl]"` with `@theme` clamp() | **Tailwind v4** |
| **Accessibility** | **All interactive components** | ARIA labels, focus management, keyboard navigation, WCAG AAA | **Built-in** |
| **Reduced Motion** | **All animations** | `className="motion-safe:animate-fade-in motion-reduce:opacity-100"` | **Tailwind CSS** |
| **Performance** | **Large lists (100+ items)** | Virtualization with `@tanstack/react-virtual` | **Best Practice** |
| **Optimistic UI** | **Form submissions** | `useOptimistic()` hook for instant feedback | **React 19** |

---

**Related:**
- `01-architecture.md` - File placement for component files
- `03-react.md` - Component composition patterns
- `07-forms.md` - Form validation with Field components
- `docs/shadcn-components-docs/` - Full API reference for all components

---

## Common Violations and Fixes

### Violation 1: Custom styling on CardTitle
```tsx
// ❌ WRONG
<CardTitle className="text-2xl font-bold text-blue-600">Title</CardTitle>

// ✅ FIX
<CardTitle>Title</CardTitle>
```

### Violation 2: Using Card for everything
```tsx
// ❌ WRONG
<Card>
  <CardContent>No data available</CardContent>
</Card>

// ✅ FIX
<Empty>
  <EmptyTitle>No data available</EmptyTitle>
</Empty>
```

### Violation 3: Manual dark mode toggling
```tsx
// ❌ WRONG
const [theme, setTheme] = useState('light')
<div className={theme === 'dark' ? 'bg-gray-900' : 'bg-white'}>

// ✅ FIX
<div className="bg-white dark:bg-gray-900">
```

### Violation 4: Inline styles
```tsx
// ❌ WRONG
<div style={{ backgroundColor: 'red', padding: '16px' }}>

// ✅ FIX
<div className="bg-red-500 p-4">
```

### Violation 5: Breaking composition
```tsx
// ❌ WRONG
<Dialog>
  <DialogTitle>Title</DialogTitle>
  <DialogContent>Content</DialogContent>
</Dialog>

// ✅ FIX
<Dialog>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Title</DialogTitle>
    </DialogHeader>
    Content
  </DialogContent>
</Dialog>
```

### Violation 6: Using deprecated InputOTP render props (Nov 2025)
```tsx
// ❌ WRONG - Deprecated render props pattern
import { SlotProps } from "input-otp"

<InputOTP maxLength={6} render={({ slots }) => (
  <div>
    {slots.map((slot, idx) => (
      <div key={idx}>{slot.char}</div>
    ))}
  </div>
)} />

// ✅ FIX - Composition pattern
import { InputOTP, InputOTPGroup, InputOTPSlot } from "@/components/ui/input-otp"

<InputOTP maxLength={6}>
  <InputOTPGroup>
    <InputOTPSlot index={0} />
    <InputOTPSlot index={1} />
    <InputOTPSlot index={2} />
    <InputOTPSlot index={3} />
    <InputOTPSlot index={4} />
    <InputOTPSlot index={5} />
  </InputOTPGroup>
</InputOTP>
```

### Violation 7: Using deprecated tailwindcss-animate (Tailwind v4)
```css
/* ❌ WRONG - Old plugin */
@import "tailwindcss";
@plugin 'tailwindcss-animate';

/* ✅ FIX - New animation library */
@import "tailwindcss";
@import "tw-animate-css";
```

### Violation 8: Wrapping chart colors with hsl() (Tailwind v4)
```tsx
// ❌ WRONG - Unnecessary hsl() wrapper
const chartConfig = {
  desktop: {
    label: "Desktop",
    color: "hsl(var(--chart-1))",
  },
} satisfies ChartConfig

// ✅ FIX - Direct variable reference
const chartConfig = {
  desktop: {
    label: "Desktop",
    color: "var(--chart-1)",
  },
} satisfies ChartConfig
```

---

## Tailwind CSS v4 Migration Guide

**Tailwind CSS v4 is a major rewrite with breaking changes. This guide covers the complete migration process.**

### Prerequisites
- **Node.js 20+** required (v4 won't work on older versions)
- **Browser support:** Safari 16.4+, Chrome 111+, Firefox 128+ (if you need older browsers, stay on v3.4)

### Automated Migration (Recommended)

Tailwind v4 provides an automated upgrade tool that handles most migration tasks:

```bash
# Run the automated migration tool
npx @tailwindcss/upgrade@next

# The tool will:
# ✅ Update dependencies to v4 packages
# ✅ Migrate tailwind.config.js to CSS @theme syntax
# ✅ Convert @tailwind directives to @import
# ✅ Update template files
# ✅ Remove deprecated plugins (postcss-import, autoprefixer)
```

### Manual Migration (Step-by-Step)

If you need more control or the automated tool fails:

### Step 1: Update Dependencies
```bash
# Update Tailwind and related packages
pnpm up "@radix-ui/*" cmdk lucide-react recharts tailwind-merge clsx --latest

# Or with npm
npm install "@radix-ui/*" cmdk lucide-react recharts tailwind-merge clsx --latest

# Install Tailwind CSS v4 (if not using upgrade tool)
npm install tailwindcss@next @tailwindcss/postcss@next

### Step 2: Replace Animation Plugin
**In `app/globals.css`:**
```diff
@import "tailwindcss";

- @plugin 'tailwindcss-animate';
+ @import "tw-animate-css";

:root {
  /* ... */
}
```

### Step 3: Update Chart Configurations
**Remove `hsl()` wrapper from chart configs:**
```diff
const chartConfig = {
  desktop: {
    label: "Desktop",
-    color: "hsl(var(--chart-1))",
+    color: "var(--chart-1)",
  },
  mobile: {
    label: "Mobile",
-   color: "hsl(var(--chart-2))",
+   color: "var(--chart-2)",
  },
} satisfies ChartConfig
```

### Step 4: Update shadcn/ui Components
```bash
# Commit current changes first
git add .
git commit -m "chore: prepare for Tailwind v4 migration"

# Update all components
npx shadcn@latest add --all --overwrite

# Specifically update Calendar if used
npx shadcn@latest add calendar --overwrite
npx shadcn@latest add calendar-02 --overwrite
```

### Step 5: Custom Breakpoints (if needed)
**Old approach (Tailwind v3):**
```js
// tailwind.config.js
module.exports = {
  theme: {
    extend: {
      screens: {
        '3xl': '1920px',
      }
    }
  }
}
```

**New approach (Tailwind v4):**
```css
/* app/globals.css */
@import "tailwindcss";

@theme {
  --breakpoint-3xl: 120rem; /* 1920px */
}
```

### Step 6: Verify Dark Mode
Dark mode should still work with `dark:` utilities, but verify your configuration:

```css
/* app/globals.css - For class-based dark mode */
@import "tailwindcss";

@custom-variant dark (&:where(.dark, .dark *));
```

**Or rely on system preference (default):**
```tsx
// No configuration needed - dark: utilities work automatically
<div className="bg-white dark:bg-gray-900">
  {/* Content */}
</div>
```

### Step 7: Test Everything
```bash
# Run development server
npm run dev

# Check for deprecated patterns
rg "@plugin ['\"]tailwindcss-animate['\"]" --glob "*.css"
rg "hsl\(var\(--chart-" --type tsx

# Verify new animation library
rg "@import \"tw-animate-css\"" --glob "*.css"
```

---

## React 19 Compatibility

shadcn/ui components are fully compatible with React 19. If you encounter peer dependency warnings:

### Update Peer Dependencies
Most packages now include React 19 support:
```json
"peerDependencies": {
  "react": "^16.8 || ^17.0 || ^18.0 || ^19.0",
  "react-dom": "^16.8 || ^17.0 || ^18.0 || ^19.0"
}
```

### If Using React 19
```bash
# Ensure all Radix UI packages support React 19
pnpm up "@radix-ui/*" --latest

# Update other UI dependencies
pnpm up lucide-react cmdk recharts --latest
```

### Simplified Ref Handling (React 19)
Modern shadcn components no longer require `React.forwardRef` in many cases:

```tsx
// ⚠️ OLD (React 18 and below)
const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn("border-b last:border-b-0", className)}
    {...props}
  />
))
AccordionItem.displayName = "AccordionItem"

// ✅ NEW (React 19+) - Simplified
function AccordionItem({ className, ...props, ref }: ComponentProps) {
  return (
    <AccordionPrimitive.Item
      ref={ref}
      className={cn("border-b last:border-b-0", className)}
      {...props}
    />
  )
}
```

**Note:** Current shadcn/ui components still use `forwardRef` for broader compatibility. This pattern will evolve as React 19 adoption increases.

---

## Summary

**Golden Rules:**
1. shadcn/ui components ONLY - no other UI libraries
2. Semantic components over generic Card usage
3. Never edit `components/ui/*` files
4. Tailwind utilities ONLY - no custom CSS
5. Follow documented composition patterns exactly
6. Leave structural slots unstyled (unless documented exception)
7. Dark mode via `dark:` prefix, not manual class toggling
8. Mobile-first responsive design with breakpoint prefixes
9. CSS variables in `app/globals.css` for theme customization
10. Check `docs/shadcn-components-docs/` before using any component
11. Never edit `app/globals.css` files
